# 変換の傾向について

---

## 質問

逆にいうと位置交換が1番多いのがCEFってことですか？

また、裏返しの多さでは順位はどうなりますか？

---

## 回答・考察まとめ

### 位置交換（動く頻度）の上位
- **F（ライム–ブロッコ）**…**75.6%**
- **E（花火–ブロッコ）**…**75.4%**
- **C（丸–桜）**…**74.0%**
（次点：β 72.9%、B 72.4%、α 71.9%、D 71.3%、γ 70.6%、A 70.6%）
※F/Eは最上位だがDは中位、Cも上位です。

### 裏返し（めくり）の多さ・順位

1. **γ（丸–ブロッコ）**…**38.4%**
2. **α（クッキー–花火）**…**31.3%**
3. **β（ライム–桜）**…**27.4%**
4. **B（クッキー–桜）**…**26.9%**
5. **E（花火–ブロッコ）**…**26.0%**
6. **D（ライム–花火）**…**24.8%**
7. **A（丸–クッキー）**…**23.0%**
8. **C（丸–桜）**…**20.7%**
9. **F（ライム–ブロッコ）**…**18.6%**

ポイント：裏返しはクロス3枚（γ, α, β）が上位を独占。一方でF/Cは裏返し少なめだけど位置はよく動くという傾向。

---

## 結論（要点）

- **評価方法**：各ペア（30C2=435）を、裏返し最小→同点なら位置交換最小で最適化して比較。辞書順の正規化に依存しない“実操作ベース”。
- **位置が動きやすいカード**：**F > E > C**（次いで β, B, α, D, γ, A）。
  - とくにF・E・Cは“位置交換の起点になりがち”。
- **裏返しが多いカード**：**γ > α > β > B > E > D > A > C > F**。
  - クロス（γ, α, β）が上位。F/Cはめくり少なめ＝“向きは安定”。
- **よく起こる2枚入れ替え**：E–β, A–D, C–F, α–βなどが多め。
  - 寒側（D,E,F）とクロス（α,β,γ）の絡み、C–Fも頻出。
- **記憶戦略（位置アンカー）**：
  - 覚えるならAとγがコスパ良い（次点D）。
  - 1枚ならA、2枚ならA+γで十分“基準点”になりやすい。
  - 3枚（A+γ+D）まで覚えられるなら理想だが、現実的には1〜2枚が最適。
- **一意性について**：マークだけでは各題で32/40/48通りの割当が成立し一意ではない。傾向把握にはペア最適化で「裏返し＋交換」を同時最小化するのが妥当。
- **全体像**：理論上の176有効パターンは“9ビット対称”だが、実機30題は偏りあり（制作側の選題に癖がある）。

> **要するに、「位置は F/E/C が動きやすい」「裏返しは γ/α/β が多い」。覚えるなら A（＋γ）がアンカー。クロスの向きから素早く充填→残りを交換で寄せるのが一番効率的です。**

---

## 分析・使用データ・手順

### 使ったデータ
1. **512_Patterns_of_Nine_Tile.csv**：512×9の0/1。各列=カード（A..γ）表裏ビット。
2. **実機30題**（あなたが提供）：各行=9マスの6進数（0丸,1クッキー,2桜,3ライム,4花火,5ブロッコ）
3. csvファイルとして変換・データ処理。

### データ処理の手順概要
#### A. 前処理（全体共通）
- 512表から“有効176”パターンを抽出
- クロス3枚（γ,β,α）の向きで暖:寒分類
- 結果csvを複数出力

#### B. 代表割当て（補助ルート）
- 実機30題を“代表的な割当”に変換（各題で一意でないため、便宜的選択）
- 代表割当を使った参考統計も出力

#### C. ペア最適化（結論の根拠）
- 各ペアごとにカード割当て・表裏・位置交換を同時に最適化
- 動きやすさ（位置交換）・裏返しの多さ等すべてこの最適化判定を根拠
- 結果csvを根拠として出力

---

## 主要ファイル一覧（GitHub管理）
- ninetiles_valid_176_patterns.csv
- ninetiles_176_class_counts.csv
- ninetiles_176_flip_by_bit_stratified.csv
- ninetiles_176_flip_by_bucket_stratified.csv
- device_30_patterns_codes.csv
- device_30_patterns_marks.csv
- device30_to_512_canonical_mapping.csv
- device30_canonical_bits.csv
- device30_unique_counts.csv
- device30_repr_assignment.csv
- device30_per_card_movement_flip.csv
- device30_pairwise_swaps.csv
- device30_cycle_hist.csv
- device30_dest_pref.csv
- optimal_per_card_movement_flip.csv
- optimal_pairwise_swaps.csv
- optimal_cycle_hist.csv

---

## 限界・仮定

- 実機はマークのみ可視なので、カードIDの割当ては本質的に複数解。
- 最終比較は各ペアごとに“裏返し→交換”を同時最適することで位置情報を捨てずに傾向を抽出。
- プレイ上の運用規則に合わせた別の最適化規範があれば、その規範でも再計算可能。

---

**主要ファイルはgithubリポジトリに保存されています。**
